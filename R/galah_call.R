#' Build a data request object
#' 
#' @param taxa \code{data.frame}: generated by a call to \code{\link{select_taxa}()}. This
#' argument also accepts a vector of unique species identifiers.
#' @param filters \code{data.frame}: generated by a call to \code{\link{select_filters}()}
#' @param locations \code{string}: generated by a call to \code{\link{select_locations}()}
#' @param columns \code{data.frame}: generated by a call to \code{\link{select_columns}()}
#' @param ... other function-specific request parameters
#' @export
galah_call <- function(taxa = NULL, 
                       filter = NULL, 
                       location = NULL, 
                       group_by = NULL, 
                       ...){
  
  extra_args <- list(...)
  
  if(!is.null(taxa)) {
    check_taxa_arg(taxa)
  }
  if(!is.null(filters) && !any(grepl("galah_filter", class(filter)))){
    stop("`filter` argument requires an input generated by `galah_filter()`")
  }
  # if(!is.null(location) && !any(grepl("ala_location", class(locations)))){
  #   stop("`location` argument requires an input generated by `select_locations()`")
  # }
  # if(!is.null(columns) && !any(grepl("ala_columns", class(columns)))){
  #   stop("`columns` argument requires an input generated by `select_columns()`")
  # }
  
  request <- structure(c(list(taxa = select_taxa,
                              select = galah_select, 
                              filter = galah_filter,
                              group_by = galah_group_by),
                         extra_args),
                       class = "data_request")
  
  return(request)
}