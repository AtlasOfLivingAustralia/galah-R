#' Build a data request object
#' 
#' @param taxa \code{data.frame}: generated by a call to \code{\link{search_taxa}()}. This
#' argument also accepts a vector of unique species identifiers.
#' @param filter \code{data.frame}: generated by a call to \code{\link{select_filters}()}
#' @param geolocate \code{string}: generated by a call to \code{\link{select_locations}()}
#' @param select \code{data.frame}: generated by a call to \code{\link{select_columns}()}
#' @param ... other function-specific request parameters
#' @export
galah_call <- function(taxa = NULL, 
                       filter = NULL, 
                       select = NULL,
                       geolocate = NULL, 
                       group_by = NULL, 
                       ...){
  
  extra_args <- list(...)
  
  if(!is.null(taxa)) {
    check_taxa_arg(taxa)
  }
  if(!is.null(filter) && !any(grepl("galah_filter", class(filter)))){
    stop("`filter` argument requires an input generated by `galah_filter()`")
  }
  if(!is.null(select) && !any(grepl("galah_select", class(select)))){
    stop("`select` argument requires an input generated by `galah_select()`")
  }
  if(!is.null(location) && !any(grepl("galah_geolocate", class(galah_geolocate)))){
    stop("`geolocate` argument requires an input generated by `galah_geolocate()`")
  }
  if(!is.null(group_by) && !any(grepl("galah_group_by", class(group_by)))){
    stop("`group_by` argument requires an input generated by `galah_group_by()`")
  }
  
  request <- structure(c(list(taxa = taxa,
                              select = select, 
                              filter = filter,
                              geolocate = geolocate,
                              group_by = group_by),
                         extra_args),
                       class = "data_request")
  
  return(request)
}