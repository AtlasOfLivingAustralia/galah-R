# Build a data request object
data_request <- function(taxa = NULL, filter = NULL, location = NULL,
                      select = NULL, ...){
  
  extra_args <- list(...)
  
  if(!is.null(taxa)) {
    check_taxa_arg(taxa)
  }
  if(!is.null(filter) && !any(grepl("galah_filter", class(filter)))){
    stop("`filters` argument requires an input generated by `galah_filter()`")
  }
  if(!is.null(location) && !any(grepl("galah_location", class(location)))){
    stop("`locations` argument requires an input generated by `galah_location()`")
  }
  if(!is.null(select) && !any(grepl("galah_select", class(select)))){
    stop("`select` argument requires an input generated by `galah_select()`")
  }
  
  request <- structure(c(list(taxa = taxa, 
                          filter = filter,
                          location = location,
                          select = select), extra_args),
                       class = "data_request")
  
  return(request)
}
