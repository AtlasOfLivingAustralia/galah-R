<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Download data reproducibly • galah</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Download data reproducibly">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">galah</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/quick_start_guide.html">Quick start guide</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Get started</h6></li>
    <li><a class="dropdown-item" href="../articles/choosing_an_atlas.html">Choosing an atlas</a></li>
    <li><a class="dropdown-item" href="../articles/look_up_information.html">Look up information</a></li>
    <li><a class="dropdown-item" href="../articles/narrow_your_results.html">Narrow your results</a></li>
    <li><a class="dropdown-item" href="../articles/download_data.html">Download data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/object_oriented_programming.html">Object-oriented programming</a></li>
    <li><a class="dropdown-item" href="../articles/download-data-reproducibly.html">Reproduciblility</a></li>
    <li><a class="dropdown-item" href="../articles/taxonomic_filtering.html">Taxonomic filtering</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_filtering.html">Spatial filtering</a></li>
    <li><a class="dropdown-item" href="../articles/temporal_filtering.html">Temporal filtering</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AtlasOfLivingAustralia/galah-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Download data reproducibly</h1>
                        <h4 data-toc-skip class="author">Dax Kellie
&amp; Martin Westgate</h4>
            
            <h4 data-toc-skip class="date">2025-02-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AtlasOfLivingAustralia/galah-R/blob/main/vignettes/download-data-reproducibly.Rmd" class="external-link"><code>vignettes/download-data-reproducibly.Rmd</code></a></small>
      <div class="d-none name"><code>download-data-reproducibly.Rmd</code></div>
    </div>

    
    
<p>Reproducible data downloads are important for a project’s long-term
use and longevity. Below we briefly discuss why galah queries aren’t
reproducible by default, how to make a data download reproducible, and
how to download the same data again in future.</p>
<div class="section level2">
<h2 id="the-trade-off-of-new-data">The trade-off of new data<a class="anchor" aria-label="anchor" href="#the-trade-off-of-new-data"></a>
</h2>
<p>By default, galah downloads data directly from each Living Atlas API.
This default means that galah automatically downloads the most
up-to-date data available (yay!).</p>
<p>Living Atlases, however, are constantly ingesting more data. These
new data may be from within the last week, the last year, or the last
hundred years, depending on the source. As a result, even if we run the
same query, the data we download today may return a different result
from the data we downloaded yesterday! Frequent data ingestion means
that although galah is useful because it downloads the latest data,
galah won’t necessarily return the same data every time we run the same
query. How can we preserve the result returned by a query if the query
always changes?</p>
<p>We recommend you take two steps to ensure your data are stable:</p>
<ul>
<li>download data to a specified location so you can find and re-use it
later</li>
<li>request a DOI with your download so you can request it again if
needed (and cite it correctly!)</li>
</ul>
<p>These steps are independent, so you can choose whether to enact none,
one, or both of them in the same workflow. We will show you how to do
both.</p>
</div>
<div class="section level2">
<h2 id="generate-a-data-doi">Generate a data DOI<a class="anchor" aria-label="anchor" href="#generate-a-data-doi"></a>
</h2>
<p>To make data downloads reproducible, galah allows us to mint a unique
<em>DOI</em> (Digital Object Identifier) for a specific query and its
subsequent result.</p>
<p>A DOI works very similarly to a url, in that it holds content that is
accessed using a specific link. However, a url can “break” if the url is
renamed or the content once found under a certain url is moved to a new
url. In contrast, a DOI is persistent and will always direct a user to
the same content, even if the url changes. This persistence is why DOIs
are valuable for long-term reproducibility of content.</p>
<p>In galah, you can also add a DOI to your download query. You just
need to add <code>mint_doi = TRUE</code> to
<code><a href="../reference/atlas_.html">atlas_occurrences()</a></code>. A unique DOI will be assigned to the
resulting object once the query is run.</p>
<p>Please note that DOI generation and reload is currently supported
only for queries to the Atlas of Living Australia. GBIF provides a DOI
with every download, but at the time of writing, they don’t provide an
API to use that DOI to download the dataset a second time. Other atlases
don’t support DOIs at all (yet).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://galah.ala.org.au/R/">galah</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/galah_config.html">galah_config</a></span><span class="op">(</span>email <span class="op">=</span> <span class="st">"your-email-here"</span>,</span>
<span>             directory <span class="op">=</span> <span class="st">"ALA_downloads"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download bandicoot occurrence records from 2003</span></span>
<span><span class="va">occs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galah_call.html">galah_call</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/identify.html" class="external-link">identify</a></span><span class="op">(</span><span class="st">"perameles"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2003</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/atlas_.html">atlas_occurrences</a></span><span class="op">(</span>mint_doi <span class="op">=</span> <span class="cn">TRUE</span>,                  <span class="co"># add DOI</span></span>
<span>                    file <span class="op">=</span> <span class="st">"bandicoots_2003_data.zip"</span> <span class="co"># specify filename</span></span>
<span>                    <span class="op">)</span></span>
<span></span>
<span><span class="va">occs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 201 × 8</span></span>
<span><span class="co">##   recordID    scientificName taxonConceptID decimalLatitude decimalLongitude</span></span>
<span><span class="co">##   &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">## 1 00300a96-e… Perameles nas… https://biodi…           -33.7             151.</span></span>
<span><span class="co">## 2 0134472a-2… Perameles nas… https://biodi…           -34.7             151.</span></span>
<span><span class="co">## 3 01e7b99e-9… Perameles gun… https://biodi…           -42.9             147.</span></span>
<span><span class="co">## 4 029c49f0-b… Perameles nas… https://biodi…           -35.1             151.</span></span>
<span><span class="co">## 5 0345dbe1-9… Perameles nas… https://biodi…           -35.5             150.</span></span>
<span><span class="co">## # ℹ 196 more rows</span></span>
<span><span class="co">## # ℹ 3 more variables: eventDate &lt;dttm&gt;, occurrenceStatus &lt;chr&gt;,</span></span>
<span><span class="co">## #   dataResourceName &lt;chr&gt;</span></span></code></pre>
<p>galah preserves lots of information in an object’s attributes, many
which are used to construct the API query sent to the specified Living
Atlas. We can view the new DOI assigned to <code>occs</code> by checking
its attributes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">occs</span><span class="op">)</span><span class="op">$</span><span class="va">doi</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "https://doi.org/10.26197/ala.7605ea98-e90f-46d4-998c-1b6673c48d34"</span></span></code></pre>
<p>We can also view information on how to cite this dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/atlas_citation.html">atlas_citation</a></span><span class="op">(</span><span class="va">occs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The citation for this dataset is:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Atlas of Living Australia (7 February 2025) Occurrence download</span></span>
<span><span class="co">## https://doi.org/10.26197/ala.7605ea98-e90f-46d4-998c-1b6673c48d34</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Please consider citing R &amp; galah, in addition to your dataset:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R Core Team (2024). _R: A Language and Environment for Statistical</span></span>
<span><span class="co">## Computing_. R Foundation for Statistical Computing, Vienna, Austria.</span></span>
<span><span class="co">## &lt;https://www.R-project.org/&gt;.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Westgate M, Kellie D, Stevenson M &amp; Newman P (2025): _galah: Biodiversity</span></span>
<span><span class="co">## Data from the GBIF Node Network_. R package version 2.1.1. doi:</span></span>
<span><span class="co">## 10.32614/CRAN.package.galah</span></span></code></pre>
<p>If you need to reload this data locally, you can do that by simply
calling <code><a href="../reference/read_zip.html">read_zip()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_zip.html">read_zip</a></span><span class="op">(</span><span class="st">"./ALA_downloads/bandicoots_2003_data.zip"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 201 × 8</span></span>
<span><span class="co">##   recordID    scientificName taxonConceptID decimalLatitude decimalLongitude</span></span>
<span><span class="co">##   &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">## 1 00300a96-e… Perameles nas… https://biodi…           -33.7             151.</span></span>
<span><span class="co">## 2 0134472a-2… Perameles nas… https://biodi…           -34.7             151.</span></span>
<span><span class="co">## 3 01e7b99e-9… Perameles gun… https://biodi…           -42.9             147.</span></span>
<span><span class="co">## 4 029c49f0-b… Perameles nas… https://biodi…           -35.1             151.</span></span>
<span><span class="co">## 5 0345dbe1-9… Perameles nas… https://biodi…           -35.5             150.</span></span>
<span><span class="co">## # ℹ 196 more rows</span></span>
<span><span class="co">## # ℹ 3 more variables: eventDate &lt;dttm&gt;, occurrenceStatus &lt;chr&gt;,</span></span>
<span><span class="co">## #   dataResourceName &lt;chr&gt;</span></span></code></pre>
<p>More importantly, though, we now have a persistent link to this data
download. If we paste this DOI into your browser, we can see additional
information about our query, including a breakdown of data providers and
licensing.</p>
<div class="figure">
<img src="../reference/figures/doi-web-example.png" alt="plot of chunk atlas-support" width="100%"><p class="caption">
plot of chunk atlas-support
</p>
</div>
</div>
<div class="section level2">
<h2 id="download-data-using-a-doi">Download data using a DOI<a class="anchor" aria-label="anchor" href="#download-data-using-a-doi"></a>
</h2>
<p>To use a DOI to return the results of a query again, we’ll use
<code><a href="../reference/filter.data_request.html">galah_filter()</a></code>. We can specify that we would like to filter
our results to only the records returned by our DOI.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occs_again</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/galah_call.html">galah_call</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">doi</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">occs</span><span class="op">)</span><span class="op">$</span><span class="va">doi</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># filter by doi</span></span>
<span>  <span class="fu"><a href="../reference/atlas_.html">atlas_occurrences</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">occs_again</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 201 × 8</span></span>
<span><span class="co">##   recordID    scientificName taxonConceptID decimalLatitude decimalLongitude</span></span>
<span><span class="co">##   &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">## 1 00300a96-e… Perameles nas… https://biodi…           -33.7             151.</span></span>
<span><span class="co">## 2 0134472a-2… Perameles nas… https://biodi…           -34.7             151.</span></span>
<span><span class="co">## 3 01e7b99e-9… Perameles gun… https://biodi…           -42.9             147.</span></span>
<span><span class="co">## 4 029c49f0-b… Perameles nas… https://biodi…           -35.1             151.</span></span>
<span><span class="co">## 5 0345dbe1-9… Perameles nas… https://biodi…           -35.5             150.</span></span>
<span><span class="co">## # ℹ 196 more rows</span></span>
<span><span class="co">## # ℹ 3 more variables: eventDate &lt;dttm&gt;, occurrenceStatus &lt;chr&gt;,</span></span>
<span><span class="co">## #   dataResourceName &lt;chr&gt;</span></span></code></pre>
<p>Our query reproduces the the same records as our original query!</p>
<p>If you would like other examples, we use this DOI method to
reproducibly download data throughout the <a href="https://cleaning-data-r.ala.org.au/data-in-this-book.html" class="external-link"><em>Cleaning
Biodiversity Data in R</em></a> book.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Westgate, Dax Kellie, Matilda Stevenson, Peggy Newman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
